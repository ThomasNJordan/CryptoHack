# define file path
file_path = "src/output_5a478a5d4764257d0bbdfaed340fcbdd.txt"

# Initialize variables
n = None
e = None
ct = None

# Read the values from the file
with open(file_path, 'r') as file:
    lines = file.readlines()
    for line in lines:
        # Split the line into variable name and value
        parts = line.strip().split(' = ')
        if len(parts) == 2:
            variable_name = parts[0].strip()
            value = parts[1].strip()

            if variable_name == 'n':
                n = int(value)
            elif variable_name == 'e':
                e = int(value)
            elif variable_name == 'ct':
                ct = int(value)

# Check if values were successfully read
if n is not None and e is not None and ct is not None:
    print("n:", n)
    print("e:", e)
    print("ct:", ct)
else:
    print("Failed to read values from the file.")


# Using 30 factors! So we have to use eliptic curve factorization
# doing this in sagemath:

"""
9389357739583927789, 61840480254677493870675478686959550668015104282603395016936573305274421654080093464254501698129786715665805770398294534848541327737230446100509799165944979975574210919221733473373782116342146721283201943073418934115639915035921642952491214114080177755384493968677556911412831731745644254269889534143376662066143115512389747673217614048902090093484352451229217117443830024572110473959338131748650769814403300317824566850253720079779190804596777000824890719966548597911463225048815018770484193657157577761930426659294929774794167216611080764009190717282553579434740361577252402377955295193991433]
[15364597561881860737, 37790927459067527332588950839531413831964095879013040371743673530071443526665581157689447967583230254528219998770551322882106498803769926724303822854909921499564731559048799396069541006004637280607414135165099546910694892943293547790407552729017869171223483107363723874696148082363018408689146279711621993220002660659724271929933631816869436001549441666109582475898055192650996825618411819224498396341025299764736548163629862767282353818127724626105541827868669547451460858951974924638092728553554702329151939300464755062446426831456381646844425311624517360329396571085043382400267011787615701]
[11403460639036243901, 50918086208952426310373931025237330292312119797912067963181822778437860283483912223147685329657810538927096979023541064240660828973991171912796579470823762267399437260243087624795397364796741604622989806202478889691651287964439607634544853227379573606396240183981017790208404498962216164114459665516264213565971509707596476628820828371640773469742454214991833676066613876882677966983976330619276108050522754762264345479343582437385976502835438547501144248212957701925324414652869458687845123139205996659270567258071230705065137252764329507715076145917954885127546617593526796735735850728137337]
[13099895578757581201, 44324200021899137327887582808423268324306554269030398988497094070572123271078902768360527573161258610696131464607436644758152868284527666973467391279961860804494697535789417792212815787340928926246729288620830659180994550645933102956818122295902582525614749101175870312148700683503711131896389219034846023441290046556704246306071622141895997551873578092324420049371410447434893455327175253425597406934758707094868072233308724337397998139997452028238960383220832341743451333333050663882027483481598164988987425981174421971159407339686615274693735350967757010132065526860978885987469964965487237]
[11492065299277279799, 50525504056730255037540576992232230702723661510251997856855004966244875905546056764821754045397603531534415914701533451770794027495458479546064420721986470846524399043005782769130595085349869785934038220648016848917104328266344944944166352001447660784654476773996001759531678963781974789534926049535256578602069649383750962928928746778718943804344475061232321289282859798272615299134758795754594442001198340828586191816465334255522040318565873946161248887619464317494580109000728654127752695725660248127574476532483057409832140791088403464466167796007938465090382017271529885445214765036855763]
[11328768673634243077, 51253795414693946767097155030774269715394942481057558120276795096303393348165460068661095123709283651783038400391187749175466773504841956936831908497452098826561994068543943476760690703638008531750046535003455194872739415465774226148014818568502479704847242873938566991027799784275248871965246826464577384545905798716921440255463983091904261470400838938969852026167491174024741295958977271377180736010005068241459130607987558771896805363809424872831201998983577379270615313778619479428341919329071621978187729428563975337427919455257709949408983417556058613129837171012784468734163416186251281]
[9389357739583927789, 61840480254677493870675478686959550668015104282603395016936573305274421654080093464254501698129786715665805770398294534848541327737230446100509799165944979975574210919221733473373782116342146721283201943073418934115639915035921642952491214114080177755384493968677556911412831731745644254269889534143376662066143115512389747673217614048902090093484352451229217117443830024572110473959338131748650769814403300317824566850253720079779190804596777000824890719966548597911463225048815018770484193657157577761930426659294929774794167216611080764009190717282553579434740361577252402377955295193991433]
[17138336856793050757, 33879739717491688897146047953126288532678730601869812868070782745366334623180084356601571604918179239595390222084778290943107072731363223879633827853112161849081101977593135619190203337944527688479253927089038794302830052731021484748902362527741145657632178954470985142036821148834212587597453411366621557280982580323843568865657202573529153659699990555356919000140047743519383574844532663127332296247415916955974801133460576067670590052695980614815995000683616757018883253943072704661947797353671901673195558129633314729361897970568951408004653666789726715008584828820901980744305331133885841]
[10336650220878499841, 56173168240329126040792784981786137920649968811604683931603792670792666576617806715107873667938435583429250959219267296361165898246483193345088515325250415887392143068350951556383680447992329457246667719782621122501165075639775357117225366131702158928785765535223370230674567554288584569956635897372817437733942988932928643958493336885339805268812977145462181301951837185928186770227916068897539448640908168249395810938637667193860656732282390057155679285784488831081643618515900687132349979997203518199269311093845223628287900090479486417785123192461699909898551301652616552900683856455772757]
[15669758663523555763, 37054967110021715549591711835017324454285663767397339246346714062271431961520827699262276353792510275977509614734750169292469231314892927802194903653588805493691595457311027195770824055724375803648188489384584554374104375014225860362788320943617156740791797787084670818662620760077302634465930327780369118263261875270551602554851671952631763611417494532060392663384077900629054606701315393078982865877558779071588549120622084650319002611416313284943836131078461011996667639913339309121011341488323316172477986437178251759625927722090286371277337148346202035993616902090612966286302461558179799]
[14278240802299816541, 40666241726734171449616972943973513681039991963801044126629084987602963178327077024154928998121846647836378896601945772034128385497370835587567023125410345233266679123104016982347312874992563614300940745109488221421753460859008378724996585914750837800571614303035667752613271159786953835960019373249142543753042713679562463808476998584924731245344999599046952038237018407018004292881221112421466742381543655689482410426945769826694969165255775624273652032782342377761634058767520164282922799012028589136083612785132771744060126678315039250791414493712550401765362603078400273535528244701216857]
[10638241655447339831, 54580673263943362055146435277661191708802346917967950583240001458194893542782824134546375593906203620188516199162583368192863456823305817329598533248727571099749413606942248315322710178977869888328963571450631371395491981567075805439068207099187080838346694837439349764593408167802200162017140264892362858936114823600061593441276083718240433996336375397728453109477056753766865204150675923421695409251476098673860079880591791755452030022872952585024805149729315398476764504327777201375940484555902238088034124686493542443967441203061996470535668594775891142633646220995180495769146861624790227]
[12955403765595949597, 44818548491771657030850368101000695149989417033611512091444783015351698357053878522635933931277764096067768408279148192336588643312694449593944585161248929443495701424591340206484158226147515655553979707238414876945540632574350035799971286710886382910556187047752459320810371687985585977361619230617864166486295869125624416204393285596367159752454257838455724603791514809853870788813761967170243616652847843953020367667600944300717221122801252706676751732586834981510289136938289890922422233368985089359973412085860777856824304523539656622734905909282170087386715147776085481522443967842663321]
[191377930710676321752005777001128441261, 3034009144850948767733787740604149299719582585874540622512549452990860501143224210530954900694520906468221599820738187612354438571557447378161640202572351272166839244784327613305110102705231955507081458690495319234771408566032633751357555115822993761248741060101830616854323540065267503488976398195949541798522490675057296213939716974288223091839481187704242019352095788350476814205803010968398827660418822214420189002641550673149457444609675497127564888275065915330777790364344822720496600937405322934775949742244001557893434852900214076893934393953881715678874817483398217]
[16656402470578844539, 34860012113928264444005274757252997325685580925771605708706618682371844747002268111620860568302145430603278665575609028768264742083539981394293770448307799985331375863625241940295310115782623277551307241080605767739743805108754828996057438402170986435352982803403821831202996695291361203534408520168174642577239026173591196424796948659303966857415988024733864077800403334802680235537401582844362877781803505527256770420913947821197371761291122567159818767802913366995739741805716219717410032462160037409843731864472569900761028532429660557282128796727242270802889106603113042751113426760579183]
[13099895578757581201, 44324200021899137327887582808423268324306554269030398988497094070572123271078902768360527573161258610696131464607436644758152868284527666973467391279961860804494697535789417792212815787340928926246729288620830659180994550645933102956818122295902582525614749101175870312148700683503711131896389219034846023441290046556704246306071622141895997551873578092324420049371410447434893455327175253425597406934758707094868072233308724337397998139997452028238960383220832341743451333333050663882027483481598164988987425981174421971159407339686615274693735350967757010132065526860978885987469964965487237]
[11328768673634243077, 51253795414693946767097155030774269715394942481057558120276795096303393348165460068661095123709283651783038400391187749175466773504841956936831908497452098826561994068543943476760690703638008531750046535003455194872739415465774226148014818568502479704847242873938566991027799784275248871965246826464577384545905798716921440255463983091904261470400838938969852026167491174024741295958977271377180736010005068241459130607987558771896805363809424872831201998983577379270615313778619479428341919329071621978187729428563975337427919455257709949408983417556058613129837171012784468734163416186251281]
[13572286589428162097, 42781471498776188152882078167977687143485348041540470040103400257592088289843763250965742461932477460992910184249899455388856522671335515793379504638043833039710356132666168214989430709680894372810694024305989132117268973444175162161965634076212337564689023017937170656186140345814810636910635880760138091289726143846911673004997952897166427861583469426244148920060018546003416678490649262294875559270057690162297237207107538623126859792403567438119710042867462155990153683593764214722762027374501197683964538218222896060765087557705929252869222684642655784444052389220267993090066333193150821]
[11328768673634243077, 51253795414693946767097155030774269715394942481057558120276795096303393348165460068661095123709283651783038400391187749175466773504841956936831908497452098826561994068543943476760690703638008531750046535003455194872739415465774226148014818568502479704847242873938566991027799784275248871965246826464577384545905798716921440255463983091904261470400838938969852026167491174024741295958977271377180736010005068241459130607987558771896805363809424872831201998983577379270615313778619479428341919329071621978187729428563975337427919455257709949408983417556058613129837171012784468734163416186251281]
[12834461276877415051, 45240885407861209487679018179878002854707087408740006567572225969909566439078303146584698101828217559710418891483823336496623527393984334873517502188208492752773839001350462424649928167692698741889514495148656262972940902774113701204727274794864232002872627987814092802236041472550626387120436179990961823094466718405238207939189988801533147501389261896745139958575734668167833468395618066263349874768329704176707050071091942885938323723573334493974916170738841399308199222588901884378838987628450766265909461411347074754288600664395991239806057711931206862643760341146263779119452903612912287]
[14278240802299816541, 40666241726734171449616972943973513681039991963801044126629084987602963178327077024154928998121846647836378896601945772034128385497370835587567023125410345233266679123104016982347312874992563614300940745109488221421753460859008378724996585914750837800571614303035667752613271159786953835960019373249142543753042713679562463808476998584924731245344999599046952038237018407018004292881221112421466742381543655689482410426945769826694969165255775624273652032782342377761634058767520164282922799012028589136083612785132771744060126678315039250791414493712550401765362603078400273535528244701216857]
[11530534813954192171, 50356934978952827503777557788505311118181809444043298133371023593324373819646956579287814968282656590129309339131123846211622566571514151038494790717077587202038061684853498245883662002993941560466829413139708729352304808940902373533606703886802206243134955262209431757965174807522136038993206423291366937154554701874016677094358351108981821783889847693018265244143542777632257474504446786890459811216006723035660124926822045434061190044829993188466843196160994517985576383431688877728782618874008763887567268008667184465113578263685778918483108884380486655467804076741140481144513470992107647]
[17138336856793050757, 33879739717491688897146047953126288532678730601869812868070782745366334623180084356601571604918179239595390222084778290943107072731363223879633827853112161849081101977593135619190203337944527688479253927089038794302830052731021484748902362527741145657632178954470985142036821148834212587597453411366621557280982580323843568865657202573529153659699990555356919000140047743519383574844532663127332296247415916955974801133460576067670590052695980614815995000683616757018883253943072704661947797353671901673195558129633314729361897970568951408004653666789726715008584828820901980744305331133885841]
[14178869592193599187, 40951247073922242812698857478930024675491311924867917645354322849295660554186741557785216322247186447953023280088805714743780006928809230863028136950360495713482798297038738667870709595283380066816073814258771080931928571979857380811382132205240426858445600657690431533432584042558841313290539866469316208488460322978829350071650310907285332201538707883327077082992533347523924998732879047412509179511195502818034184594608921929609463015011125587526808631238085867676552442492279504153032514447845648172421595127149365415896732013442277403508573154745218726014865566573069245853729798507991351]
[121879472466347035138899170664186939923, 4764070439008244706747623294271286338390838658908644027247223139003264654560268988625821316651450904371203641708990737629581887775166143810046632314537108427190885370184506895152350171993989644491773406375361247755932599530929433995618085148522235222145652470430710108174580648344329386037243600009633961661027909671908742290190158701378748767954120539191425381356840257885304267113103838773465368735549761564252982363249574600178451978439016246114669496512825829480442970976367025678039164771809424105456623013491176142937651657163183902000692880135605033790411000622249719]
[10638241655447339831, 54580673263943362055146435277661191708802346917967950583240001458194893542782824134546375593906203620188516199162583368192863456823305817329598533248727571099749413606942248315322710178977869888328963571450631371395491981567075805439068207099187080838346694837439349764593408167802200162017140264892362858936114823600061593441276083718240433996336375397728453109477056753766865204150675923421695409251476098673860079880591791755452030022872952585024805149729315398476764504327777201375940484555902238088034124686493542443967441203061996470535668594775891142633646220995180495769146861624790227]
[11665347949879312361, 49774974085093656982017411270268483202336356100939354923740452909514958067779835276456231850481875368656539412561268853811269381498947100686102347130310551445589554858220534293758283652984701270045557241759843313857991508483737307090063481270351485271231444132650864529482874598433717065759293074710307773203211498625169925761642446274415820023868800667197367244910271143897665738412896302364907868986866046838982278373522763347586817062639330934033954817004249518840387549096742809045410640467571136885518842677590379975608417826750056268457186939377103713075692271753765872737398329766981517]
[11328768673634243077, 51253795414693946767097155030774269715394942481057558120276795096303393348165460068661095123709283651783038400391187749175466773504841956936831908497452098826561994068543943476760690703638008531750046535003455194872739415465774226148014818568502479704847242873938566991027799784275248871965246826464577384545905798716921440255463983091904261470400838938969852026167491174024741295958977271377180736010005068241459130607987558771896805363809424872831201998983577379270615313778619479428341919329071621978187729428563975337427919455257709949408983417556058613129837171012784468734163416186251281]
[17281246625998849649, 33599566308213732695111765072180120517941255853967563021220281130674583722099723837783121418305227888514277753302585719230129796791229147633995347926832226898868923294251963579232049669504364251799590206964630630119065353003122155899757729994982007542702431013739809830431142688418220763904044455857102966846643636867874519751837895637699515256894754346305749850889404903528708838993538055216715078841668755700844675185728243985556923045946568553640208420057020316989746221045809763075408716626888853976345540626404744109021374894267637851673740453412966282318837865448343533015094328379083813]
[14278240802299816541, 40666241726734171449616972943973513681039991963801044126629084987602963178327077024154928998121846647836378896601945772034128385497370835587567023125410345233266679123104016982347312874992563614300940745109488221421753460859008378724996585914750837800571614303035667752613271159786953835960019373249142543753042713679562463808476998584924731245344999599046952038237018407018004292881221112421466742381543655689482410426945769826694969165255775624273652032782342377761634058767520164282922799012028589136083612785132771744060126678315039250791414493712550401765362603078400273535528244701216857]
"""

'''
# try first one first
11492065299277279799
50525504056730255037540576992232230702723661510251997856855004966244875905546056764821754045397603531534415914701533451770794027495458479546064420721986470846524399043005782769130595085349869785934038220648016848917104328266344944944166352001447660784654476773996001759531678963781974789534926049535256578602069649383750962928928746778718943804344475061232321289282859798272615299134758795754594442001198340828586191816465334255522040318565873946161248887619464317494580109000728654127752695725660248127574476532483057409832140791088403464466167796007938465090382017271529885445214765036855763
'''

'''
from src.gcd import extended_gcd
s, t, r = extended_gcd(e, n_tot)
print("Coefficients: ", s, t)

d = s

# now decrypt ct
decoded_int = pow(ct, d, n)
print("Decoded int: ", decoded_int)

from Cryptodome.Util.number import long_to_bytes, inverse

print("Plaintext: ", long_to_bytes(decoded_int))
'''